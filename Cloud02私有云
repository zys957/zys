openstack 系统环境

禁用  selinux
  修改  /etc/selinux/config
  SELINUX=disabled
  重启生效

禁用  防火墙
  systemctl stop firewalld
  yum remove firewalld-*

卸载  NetworkManager
  配置静态IP
  systemclt  stop   NetworkManager
  systemctl  enable network
  
  systemctl  mask  NetworkManager
  或
  yum remove NetworkManager

修改配置文件 /etc/sysconfig/network-scripts/ifcfg-eth0
# Generated by dracut initrd 	# 注释
DEVICE="eth0" 		# 驱动名称，与ifconfig 看到的名称一致
ONBOOT="yes" 		# 开机启动
NM_CONTROLLED="no" 	# 不接受 NetworkManager 控制
TYPE="Ethernet" 		# 类型
BOOTPROTO="static" 	# 协议(dhcp|static|none)
IPADDR="192.168.1.10" 	# IP地址
NETMASK="255.255.255.0" 	# 子网掩码
GATEWAY="192.168.1.254" 	# 默认网关


功能服务器

时间服务器
yum install chrony
修改配置文件 /etc/chrony.conf
server ntp.aliyun.com iburst
bindacqaddress 0.0.0.0
allow 0/0
local stratum 10

重启服务，验证
systemctl  restart chronyd
chronyc  sources -v
ss -ltun  |grep 123

Yum仓库
安装 vsftpd 服务
yum install vsftpd
systemctl enable --now vsftpd

上传 RHEL7-extras.iso RHEL7OSP-10.iso 到 /var/iso/
创建目录，mount 光盘
mkdir  /var/ftp/{extras,openstack}
mount -t iso9660 -o ro,loop /var/iso/RHEL7-extras.iso /var/ftp/extras
mount -t iso9660 -o ro,loop /var/iso/RHEL7OSP-10.iso /var/ftp/openstack

客户端yum配置 /etc/yum.repos.d/openstack.repo
[CentOS-Extras]
name=CentOS-$releasever - Extras
baseurl="ftp://192.168.1.250/extras"
enabled=1
gpgcheck=0

[openstack]
name=CentOS-$releasever - openstack
baseurl="ftp://192.168.1.250/openstack/rhel-7-server-openstack-10-rpms"
enabled=1
gpgcheck=0

[openstack-devtool]
name=CentOS-$releasever - openstack devtool
baseurl="ftp://192.168.1.250/openstack/rhel-7-server-openstack-10-devtools-rpms"
enabled=1
gpgcheck=0

系统环境配置（openstack，nova01，nova02 都要配置）
1、yum 源
     yum  clean all
     yum  repolist                 # 10670 软件包

2、主机名配置  /etc/hosts
192.168.1.10	openstack
192.168.1.11	nova01
192.168.1.12	nova02
192.168.1.250	repo

3、时间服务器  /etc/chrony.conf
添加  server 192.168.1.250 iburst
重启服务，验证配置 chronyc sources -v

4、域名查询服务  /etc/resolv.conf
search 开头的行必须删除
sed  '/^search /d' -i /etc/resolv.conf

安装工具软件包
在 openstack 主机安装
yum install openstack-packstack python-setuptools

在 nova01,nova02 主机安装
yum install qemu-kvm libvirt-daemon libvirt-daemon-driver-qemu libvirt-client python-setuptools
systemctl enable libvirtd

在 openstack 创建配置文件安装
packstack --gen-answer-file=answer.ini
修改配置文件(按照 PPT 里修改)

做快照！！！
做快照！！！
做快照！！！

执行安装(安装过程时间较长大约 30 分钟左右)
packstack --answer-file=answer.ini
